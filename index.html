<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>maria isolina cozzani ‚Äî portfolio</title>
  <meta name="description" content="violinist, composer-performer, multimedia artist. works, bio, contact." />

  <!-- Theme & color scheme -->
  <meta name="color-scheme" content="light">
  <meta name="theme-color" content="#ffffff">

  <!-- SEO & Social Meta (add your domain when ready) -->
  <meta property="og:title" content="Maria Isolina Cozzani - Violinist, Composer-Performer, Multimedia Artist">
  <meta property="og:description" content="Portfolio of Maria Isolina Cozzani - works, bio, contact information">
  <meta property="og:type" content="website">
  <meta property="og:image" content="assets/og-image.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="robots" content="index,follow">

  <!-- Favicon -->
  <link rel="icon" href="/assets/favicon.ico">
  <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Space+Grotesk:wght@600;700&family=Source+Sans+3:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --txt: #0a0a0d;
      --bg: #ffffff; /* layout chiaro */
      --muted: #5a5f66;
      --accent: #7ed321;
      --border: #e6e7ea;
      --max: 1440px;
      --radius: 0px;
      --brand-pink: #ff4fd8;
      --font-base: 'Source Sans 3', ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      --font-heading: 'Space Grotesk', ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      --font-curvy: 'Pacifico', cursive;
    }

    html { box-sizing: border-box; scroll-behavior: smooth; color-scheme: light; }
    *, *::before, *::after { box-sizing: inherit; }

    body {
      margin: 0;
      color: var(--txt);
      background: var(--bg);
      /* leggerissimo tocco psichedelico ma su bianco */
      background-image:
        radial-gradient(120% 120% at 12% 8%, rgba(255,79,216,.06), transparent 60%),
        radial-gradient(120% 120% at 88% 82%, rgba(126,211,33,.06), transparent 60%);
      font: 16px/1.7 var(--font-base);
      text-rendering: optimizeLegibility;
      position: relative;
      overflow-x: hidden;
      cursor: none; /* custom cow cursor (desktop) */
    }

    a { color: var(--accent); text-decoration: none; transition: all 0.2s ease; }
    a:focus-visible, button:focus-visible { outline: 2px solid var(--brand-pink); outline-offset: 3px; border-radius: 2px; }

    .wrap { max-width: var(--max); margin: 0 auto; padding: 28px 18px; position: relative; z-index: 0; }
    header { margin: 8px 0 18px; }
    h1 { font-family: var(--font-heading); font-size: 32px; font-weight: 700; letter-spacing: .02em; margin: 0 0 6px; color: var(--accent); position: relative; }
    nav { margin: 14px 0 26px; font-family: var(--font-heading); letter-spacing: .01em; font-weight: 600; }
    nav a { margin: 0 10px 0 0; white-space: nowrap; color: var(--brand-pink); position: relative; padding: 4px 0; text-decoration: underline; text-underline-offset: 3px; }
    nav a::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background: var(--brand-pink); transition: width 0.3s ease; }
    nav a:hover::after, nav a:focus-visible::after { width: 100%; }

    main section { margin: 38px 0; }
    h2 { font-family: var(--font-heading); font-size: 18px; margin: 0 0 12px; color: var(--accent); }
    h3 { font-family: var(--font-heading); font-size: 16px; margin: 0 0 8px; }
    .muted { color: var(--muted); opacity: 0.9; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

    /* Cards */
    .card { padding: 16px; border-radius: 0; background: rgba(255,255,255,.9); border: 1px solid var(--border); transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease; position: relative; z-index: 1; backdrop-filter: saturate(110%) blur(0px); }
    .card:hover { transform: translateY(-2px); box-shadow: 0 6px 22px rgba(0,0,0,0.08); border-color: var(--brand-pink); }

    /* Gallery */
    .thumbs { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
    .thumb { position: relative; display: block; border-radius: 0; overflow: hidden; background: var(--bg); border: 1px solid var(--border); transition: transform .18s ease, border-color .18s ease, box-shadow .18s ease, filter .18s ease; transform-origin:center center; transform: translateY(var(--ty,0)) scale(var(--s,1)); }
    .thumb .poster { aspect-ratio: 16/9; width: 100%; object-fit: cover; display: block; filter: grayscale(.08) contrast(1.04); transition: filter .18s ease; will-change: filter, transform; }
    .thumb:hover { border-color: var(--brand-pink); box-shadow: 0 10px 26px rgba(255,79,216,.15); --ty:-2px; }
    .thumb:hover .poster { filter: grayscale(0) contrast(1.08) saturate(1.08); }
    .thumb:focus-visible { outline: 2px solid var(--brand-pink); outline-offset: 2px; }

    /* Detail view */
    body.is-detail main > section:not(#work-detail) { display: none; }
    #work-detail { margin-top: 10px; }
    #work-detail .back { display: inline-flex; align-items: center; gap: 6px; margin: 6px 0 16px; font-size: 13px; color: var(--muted); padding: 6px 12px; border: 1px solid var(--border); border-radius: 2px; transition: all 0.2s ease; cursor: none; }
    #work-detail .back:hover { color: var(--txt); border-color: var(--brand-pink); background: rgba(255,79,216,0.05); }
    .embed { position: relative; padding-top: 56.25%; border-radius: var(--radius); overflow: hidden; border: 1px solid var(--border); background: rgba(0,0,0,0.03); margin-bottom: 14px; }
    .embed iframe { position: absolute; inset: 0; width: 100%; height: 100%; border: 0; }

    /* Media grids */
    .detail-media-grid { display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 14px; }
    @media (min-width: 900px) { .detail-media-grid { grid-template-columns: 1fr 1fr; } }
    .detail-media-grid img { width: 100%; aspect-ratio: 16/9; object-fit: cover; border-radius: 0; border: 1px solid var(--border); }
    .video-grid { display: grid; grid-template-columns: 1fr; gap: 12px; margin: 12px 0; }
    @media (min-width: 820px) { .video-grid { grid-template-columns: 1fr 1fr; } }
    .photo-grid, .media-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0; }
    @media (min-width: 720px) { .photo-grid, .media-grid { grid-template-columns: repeat(3, 1fr); } }
    .photo-grid img, .media-grid img { width: 100%; height: 100%; object-fit: cover; border-radius: 0; border: 1px solid var(--border); }
    .media-grid .span-3 { grid-column: 1/-1; }

    /* Bio */
    #bio { --aside: 260px; }
    #bio .bio-grid { display: grid; grid-template-columns: 1fr; gap: 18px; align-items: start; }
    #bio .bio-aside h2 { margin: 0 0 8px; }
    #bio .bio-aside .small { font-size: 12px; }
    #bio .bio-content { text-wrap: pretty; }
    #bio .bio-content p { margin: 0 0 12px; text-align: justify; hyphens: auto; orphans: 2; widows: 2; font-size: 15px; line-height: 1.75; }
    @media (min-width: 980px) {
      #bio .bio-grid { grid-template-columns: var(--aside) 1fr; gap: 28px; }
      #bio .bio-aside { position: sticky; top: 18px; align-self: start; }
      #bio .bio-content { column-count: 2; column-gap: 28px; column-fill: balance; }
      #bio .bio-content p { break-inside: avoid; }
    }

    /* Contact */
    .contact-line { display: inline-flex; align-items: center; gap: 10px; font-weight: 600; color: var(--txt); }
    .icon-mail { width: 18px; height: 18px; fill: var(--accent); }

    footer { margin: 44px 0 12px; font-size: 13px; color: var(--muted); }

    /* Performance */
    #works-data, #bio, #contact { content-visibility: auto; contain-intrinsic-size: 1px 1000px; }

    /* === Custom cow cursor & fireworks === */
    #fxLayer { position: fixed; inset: 0; pointer-events: none; z-index: 9998; overflow: visible; }
    .cursor-cow { position: fixed; left: 0; top: 0; width: 40px; height: 40px; transform: translate(-50%,-50%); pointer-events: none; z-index: 9999; filter: drop-shadow(0 4px 10px rgba(0,0,0,.15)); }
    .cursor-cow svg { width: 100%; height: 100%; }

    .cow-particle { position: fixed; width: 28px; height: 28px; left: 0; top: 0; transform: translate(0,0) scale(.95);
      animation: cowBurst var(--dur,2600ms) cubic-bezier(.22,.72,.12,1) forwards, cowSpin var(--dur,2600ms) linear forwards; }
    @keyframes cowBurst { from { opacity: 1; transform: translate(0,0) scale(1); } to { transform: translate(var(--dx),var(--dy)) scale(.95); opacity: 0; } }
    @keyframes cowSpin { from { rotate: 0deg; } to { rotate: var(--rot,360deg); } }

    /* Nascondi ‚Äúmanina‚Äù ovunque: */
    html, body, * { cursor: none !important; }

    /* Touch / pen: ripristina cursore di sistema e nascondi mucca */
    @media (hover:none), (pointer:coarse) {
      body { cursor: auto !important; }
      html, body, * { cursor: auto !important; }
      .cursor-cow { display: none !important; }
    }
  </style>
</head>
<body>
  <!-- particle layer and custom cursor -->
  <div id="fxLayer" aria-hidden="true"></div>
  <div id="cursorCow" class="cursor-cow" aria-hidden="true"></div>

  <!-- Cow Lab panel -->
  <div id="cowPanel" aria-label="Cow Lab" style="position:fixed;top:14px;left:14px;z-index:50;background:rgba(255,255,255,.92);border:1px solid var(--border);backdrop-filter:saturate(120%) blur(2px);padding:10px 12px;border-radius:6px;font:12px/1.4 var(--font-base);color:#222;user-select:none;">
    <strong style="display:block;margin-bottom:4px">üêÑ Cow Lab</strong>
    <label style="display:flex;align-items:center;gap:8px;margin:4px 0;">intensity
      <input type="range" id="cowIntensity" min="0" max="100" value="20" style="width:140px;">
      <span id="cowIntensityVal">20</span>
    </label>
    <label style="display:flex;align-items:center;gap:8px;margin:4px 0;">emitters
      <input type="range" id="cowEmitters" min="1" max="24" value="8" style="width:140px;">
      <span id="cowEmittersVal">8</span>
    </label>
    <small style="color:var(--muted);">Tip: hover the title for a burst.</small>
  </div>

  <!-- Cow SVG template (reused for cursor and particles) -->
  <template id="cowSVG">
    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <defs><clipPath id="cowClip"><circle cx="32" cy="34" r="20" /></clipPath></defs>
      <circle cx="32" cy="34" r="20" fill="#ffffff" stroke="#222" stroke-width="2.5"/>
      <ellipse cx="16" cy="26" rx="6" ry="8" fill="#fff" stroke="#222" stroke-width="2.5"/>
      <ellipse cx="48" cy="26" rx="6" ry="8" fill="#fff" stroke="#222" stroke-width="2.5"/>
      <ellipse cx="16" cy="26" rx="4" ry="5" fill="#ffc0d6" opacity=".8"/>
      <ellipse cx="48" cy="26" rx="4" ry="5" fill="#ffc0d6" opacity=".8"/>
      <path d="M24 16c2-4 6-4 8 0" fill="none" stroke="#9c8c63" stroke-width="3" stroke-linecap="round"/>
      <path d="M40 16c-2-4-6-4-8 0" fill="none" stroke="#9c8c63" stroke-width="3" stroke-linecap="round"/>
      <g clip-path="url(#cowClip)">
        <ellipse cx="24" cy="34" rx="8" ry="6" fill="#1a1a1a" opacity=".9"/>
        <ellipse cx="42" cy="44" rx="6" ry="4" fill="#1a1a1a" opacity=".9"/>
      </g>
      <circle cx="26" cy="34" r="2.3" fill="#111"/>
      <circle cx="38" cy="34" r="2.3" fill="#111"/>
      <ellipse cx="32" cy="46" rx="11" ry="8" fill="#ffb3c7" stroke="#222" stroke-width="2"/>
      <circle cx="28" cy="46" r="1.6" fill="#7a2a2a"/>
      <circle cx="36" cy="46" r="1.6" fill="#7a2a2a"/>
    </svg>
  </template>

  <div class="wrap">
    <header>
      <h1 id="siteTitle">maria isolina cozzani</h1>
      <nav aria-label="primary">
        <a href="#works">works</a>
        <a href="#bio">bio</a>
        <a href="#contact">contact</a>
      </nav>
    </header>

    <main id="content" role="main" tabindex="-1">
      <section id="works" aria-label="works">
        <h2 class="sr-only">works</h2>
        <div class="gallery grid thumbs" id="thumbs"></div>
      </section>

      <section id="work-detail" class="work-detail" hidden></section>

      <section id="bio" hidden>
        <div class="bio-grid">
          <aside class="bio-aside">
            <h2>bio</h2>
            <p class="muted small">Extended CV and photos available on request.</p>
          </aside>
          <div class="bio-content">
            <p><strong>Maria Isolina Cozzani</strong> (b. 1994, Ludwigsburg) is an Italian-German violinist, composer-performer and multimedia artist based in Cologne. Working at the edges of free improvisation, electroacoustic performance and installation, she focuses on timbral extremes of the violin, spectral/granular resynthesis and spatial sound (4‚Äì8-channel and site-responsive setups). Her practice often integrates audio-reactive objects and upcycled technologies, assembling fragile yet vibrant ecosystems where sound, bodies and space co-shape one another.</p>
            <p>She trained in classical and jazz violin at the conservatories of La Spezia and Genoa and completed an MMus at ArtEZ University of the Arts (Arnhem, 2023) with research in free improvisation that culminated in <em>ISLN ‚Äî Geography of sounds, shapeshifting multiplicities</em>. Recent and ongoing projects include the free-improv quintet <em>Inopia</em> (album <em>Exoplanet</em>, 2025); the electroacoustic duo <em>O.P.M.L. ‚Äî Our Past Microtonal Love</em>; and the ensembles <em>Trio Lavish</em> (winners of the <em>Erasmus Jazz Prijs 2023</em>) and <em>Edera Trees</em>.</p>
            <p>Her music draws on microtonality (simple frequency relations beyond tempered systems), memory as layering/return, and a choreographic attention to gesture, instrument and space. She has appeared at Palazzo Ducale (Genoa), Museo Bagatti Valsecchi (Milan), MA/IN Matera Intermedia Festival (Matera), De Thomas (Amsterdam) and The Grey Space (The Hague).</p>
            <p>Alongside artistic work, Maria is active as an educator and as a project manager. In 2025 she coordinated the interdisciplinary project week <em>Connecting the Dots</em> at ArtEZ University of the Arts, leading planning and delivery for ~40 Master students across departments, guest-lecturer scheduling, rooming and documentation.</p>
          </div>
        </div>
      </section>

      <section id="contact" hidden>
        <h2>contact</h2>
        <p class="contact-line">
          <svg class="icon-mail" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M3 6.75A1.75 1.75 0 0 1 4.75 5h14.5A1.75 1.75 0 0 1 21 6.75v10.5A1.75 1.75 0 0 1 19.25 19H4.75A1.75 1.75 0 0 1 3 17.25V6.75Zm1.9.2 7.08 5.31c.13.1.31.1.44 0l7.08-5.31a.25.25 0 0 0-.15-.45H5.05a.25.25 0 0 0-.15.45Zm14.15 1.69-6.43 4.82a2.25 2.25 0 0 1-2.84 0L3.35 8.64v8.61c0 .14.11.25.25.25h16.8c.14 0 .25-.11.25-.25V8.64Z"></path>
          </svg>
          <span id="mail"></span>
        </p>
      </section>

      <section id="works-data" hidden>
        <!-- (I tuoi <article> originali ‚Äì invariati) -->
        <article class="card" id="violin-algorithm-duet" data-title="Violin and Algorithm Duet"
                 data-yt="dUpo4ffqWa8"
                 data-poster="https://img.youtube.com/vi/dUpo4ffqWa8/hqdefault.jpg">
          <h3><em>Violin and Algorithm Duet</em> (2025)</h3>
          <p><strong>Violin</strong> - Maria Isolina Cozzani<br>
          <strong>Machine listening, concatenative synthesis algorithm</strong> - Matteo Traverso<br>
          <strong>Concept</strong> - Maria Isolina Cozzani, Matteo Traverso</p>
          <p>This piece is an improvised duo between violin and algorithm. During the first two minutes the violin improvises alone, providing the sound material. The algorithm's playback is determined by the violin's musical decisions. In the duet section, the two players influence each other‚Äîtexturally and structurally.</p>
          <p><strong>Video:</strong> <a href="https://youtu.be/dUpo4ffqWa8" target="_blank" rel="noopener">YouTube</a></p>
        </article>

        <article class="card" id="what-is-left" data-title="what is left, what there grows"
                 data-poster="assets/what_is_left/what-is-left-cover.jpg"
                 data-drive="1PxZBF0uUqdAcqpShlq9IUOrqWa6HcPv5">
          <h3><em>what is left, what there grows</em> (2025)</h3>
          <p class="muted">Finalist at MA/IN Matera Intermedia Festival 2025.</p>
          <p>"what is left, what there grows" is a self-reactive environment composed of sound, immersive multi-channel audio (4‚Äì8 channels), upcycled trash speakers, small robots, and obsolete or broken technological remains‚Äîmotherboards, wires, machine parts. Although over 90% of the installation is built from discarded or recycled materials, the experience it offers is one of vitality, regeneration, and ongoing transformation‚Äîwhether driven by internal desire or external intervention.</p>
          <p>The installation evokes a kind of natural ritual in which the Anthropocene compresses geological eras, accelerating fossil formation through human waste. Decades of technological residue converge, reshaping sound, air, shadow, and perception, exposing a fractured sense of detachment from our consumer responsibilities.</p>
          <p>This is a fragile, eroded, yet vibrant environment in constant flux. All elements‚Äîrobots, sound structures, speakers‚Äîlisten and respond to one another; the system is entirely audio-reactive, including its interaction with the audience. The presence of living, reactive technology gives the impression of stepping into a sacred terrain, made of a new kind of nature‚Äîwhere even stepping over a cable or past a tiny machine feels intrusive.</p>
          <p>The installation sustains a delicate balance. It no longer needs the human, and barely welcomes them‚Äîexcept as careful listener, as silent observer.</p>
          <p><strong>Media:</strong> <a href="https://drive.google.com/file/d/1PxZBF0uUqdAcqpShlq9IUOrqWa6HcPv5/preview" target="_blank" rel="noopener">Video (Drive)</a></p>
        </article>

        <article class="card" id="exoplanet" data-title="Exoplanet ‚Äî Inopia"
                 data-poster="assets/exoplanet/SM4830.jpg">
          <h3><em>Exoplanet</em> ‚Äî Inopia (2025)</h3>
          <p><strong>EXOPLANET</strong> is a sonic exploration of human existence in an age of global crises...</p>
          <div class="media-grid">
            <img class="span-3" src="assets/exoplanet/SM4830.jpg" alt="Exoplanet cover" loading="lazy" decoding="async" width="1600" height="900">
            <img src="assets/exoplanet/DSC_4362.jpg" alt="Inopia live 1" loading="lazy" decoding="async" width="800" height="533">
            <img src="assets/exoplanet/DSC_4403.jpg" alt="Inopia live 2" loading="lazy" decoding="async" width="800" height="533">
            <img src="assets/exoplanet/DSC_4930.jpg" alt="Inopia live 3" loading="lazy" decoding="async" width="800" height="533">
            <img src="assets/exoplanet/unbenannt-8811.jpg" alt="Inopia portrait blurred" loading="lazy" decoding="async" width="800" height="533">
          </div>
        </article>

        <!-- ... (resto dei tuoi <article> invariati) ... -->

        <article class="card" id="studio-sul-plasma" data-title="Studio sul plasma" data-yt="o3UOTGCL5_Q">
          <h3><em>Studio sul plasma</em> (2019)</h3>
          <p>3D particles audio-reactive system emulating plasma behaviour...</p>
          <p><strong>Media:</strong> <a href="https://www.youtube.com/watch?v=o3UOTGCL5_Q&ab_channel=art%C3%A8r%C3%ACa" target="_blank" rel="noopener">YouTube</a></p>
        </article>
      </section>
    </main>

    <footer>
      <p>¬© <span id="y"></span> Maria Isolina Cozzani</p>
    </footer>
  </div>

  <!-- JSON-LD base (espandi con tuo dominio) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Person",
    "name":"Maria Isolina Cozzani",
    "jobTitle":"Violinist, Composer-Performer, Multimedia Artist",
    "url":"https://tuodominio.example/",
    "worksFeatured":[
      {"@type":"CreativeWork","name":"Violin and Algorithm Duet","url":"https://tuodominio.example/#work/violin-algorithm-duet"},
      {"@type":"CreativeWork","name":"what is left, what there grows","url":"https://tuodominio.example/#work/what-is-left"}
    ]
  }
  </script>

  <script>
  'use strict';

  // Footer year
  document.getElementById('y').textContent = new Date().getFullYear();

  const worksSection = document.querySelector('#works-data');
  const thumbsWrap   = document.getElementById('thumbs');
  const siteTitle    = document.getElementById('siteTitle');

  const POSTER_OVERRIDES = {
    'violin-algorithm-duet': 'https://img.youtube.com/vi/dUpo4ffqWa8/hqdefault.jpg',
    'artemide': 'assets/artemide/artemide_6.jpg',
    'exoplanet': 'assets/exoplanet/SM4830.jpg',
    'lavish-trio': 'assets/dump_and_die/lavish-cover-1200.jpg',
    'isln': 'assets/ISLN/isln-cover-1200.jpg',
    'edera': 'assets/edera/edera1.jpeg',
    '1142km': 'assets/1142_km/1492.png',
    'solo-livingroom': 'assets/livingroom/livingroom.jpg'
  };

  const rand = (min, max) => Math.random() * (max - min) + min;
  const getYouTubeThumb = id => `https://img.youtube.com/vi/${id}/hqdefault.jpg`;

  // Build gallery
  function buildThumb(article) {
    const id = article.id;
    const title = article.dataset.title || id;
    let thumbURL = '';

    if (article.dataset.poster) {
      try { thumbURL = new URL(article.dataset.poster, document.baseURI).href; }
      catch (e) { thumbURL = article.dataset.poster; }
    }
    if (!thumbURL && POSTER_OVERRIDES[id]) thumbURL = POSTER_OVERRIDES[id];
    if (!thumbURL && (article.dataset.yt || article.dataset.ytList)) {
      const firstId = (article.dataset.yt || article.dataset.ytList.split(',')[0].trim());
      thumbURL = getYouTubeThumb(firstId);
    }

    const a = document.createElement('a');
    a.href = `#work/${id}`;
    a.className = 'thumb';
    a.setAttribute('aria-label', title);
    a.style.setProperty('--s', '1');

    if (thumbURL) {
      const img = document.createElement('img');
      img.className = 'poster';
      img.loading = 'lazy';
      img.decoding = 'async';
      img.alt = title;
      img.src = thumbURL;
      a.appendChild(img);
    } else {
      const ph = document.createElement('div');
      ph.className = 'poster';
      ph.style.background = 'linear-gradient(135deg, rgba(0,0,0,0.06), rgba(0,0,0,0.02))';
      a.appendChild(ph);
    }
    return a;
  }

  function buildGallery() {
    thumbsWrap.innerHTML = '';
    if (!worksSection) return;

    const desiredOrder = [
      'violin-algorithm-duet','what-is-left','exoplanet','lavish-trio',
      'isln','artemide','solo-livingroom','edera','1142km','locked-outputs',
      'studio-sul-plasma','steps-to-be-taken'
    ];

    const orderMap = new Map(desiredOrder.map((id, i) => [id, i]));
    const articles = Array.from(worksSection.querySelectorAll('article'))
      .sort((a, b) => (orderMap.get(a.id) ?? 999) - (orderMap.get(b.id) ?? 999));

    articles.forEach((a, idx) => {
      const el = buildThumb(a);
      const img = el.querySelector('img');
      if (idx < 2 && img) img.setAttribute('fetchpriority', 'high');
      thumbsWrap.appendChild(el);
    });
  }

  function createEmbedIframe(kind, id, title) {
    const div = document.createElement('div');
    div.className = 'embed';
    let url = '';
    if (kind === 'yt') {
      url = `https://www.youtube-nocookie.com/embed/${id}`;
      div.innerHTML = `<iframe loading="lazy" src="${url}" title="${title}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
    } else if (kind === 'vimeo') {
      url = `https://player.vimeo.com/video/${id}?dnt=1&byline=0&portrait=0`;
      div.innerHTML = `<iframe loading="lazy" src="${url}" title="${title}" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
    } else if (kind === 'drive') {
      url = `https://drive.google.com/file/d/${id}/preview`;
      div.innerHTML = `<iframe loading="lazy" src="${url}" title="${title}"></iframe>`;
    }
    return div;
  }

  function createMediaBlock(article) {
    const ds = article.dataset;
    const title = ds.title || article.id;
    const entries = [];

    if (ds.ytList)   ds.ytList.split(',').map(s=>s.trim()).filter(Boolean).forEach(id => entries.push(['yt', id]));
    if (ds.vimeoList) ds.vimeoList.split(',').map(s=>s.trim()).filter(Boolean).forEach(id => entries.push(['vimeo', id]));
    if (ds.driveList) ds.driveList.split(',').map(s=>s.trim()).filter(Boolean).forEach(id => entries.push(['drive', id]));
    if (ds.yt)    entries.push(['yt', ds.yt]);
    if (ds.vimeo) entries.push(['vimeo', ds.vimeo]);
    if (ds.drive) entries.push(['drive', ds.drive]);

    if (entries.length === 0) return null;

    if (entries.length === 1 && ds.poster && !article.querySelector('img')) {
      const wrap = document.createElement('div');
      wrap.className = 'detail-media-grid';
      wrap.appendChild(createEmbedIframe(entries[0][0], entries[0][1], title));
      const img = document.createElement('img');
      img.src = ds.poster; img.alt = title; img.loading = 'lazy'; img.decoding = 'async';
      wrap.appendChild(img);
      return wrap;
    }

    const container = document.createElement('div');
    if (entries.length > 1) container.className = 'video-grid';
    entries.forEach(([kind, id]) => container.appendChild(createEmbedIframe(kind, id, title)));
    return container;
  }

  function setActiveNav(section) {
    document.querySelectorAll('nav a[href^="#"]').forEach(a => {
      a.removeAttribute('aria-current');
      if (a.getAttribute('href') === `#${section}`) a.setAttribute('aria-current','page');
    });
  }

  function showTop(section) {
    ['works','bio','contact'].forEach(id => {
      const el = document.getElementById(id);
      if (el) el.hidden = (id !== section);
    });
    document.body.classList.remove('is-detail');
    const detailEl = document.getElementById('work-detail');
    if (detailEl) { detailEl.setAttribute('hidden',''); detailEl.innerHTML = ''; }
    if (section === 'works') window.scrollTo(0,0);
    setActiveNav(section);
  }

  function showWork(slug) {
    const article = document.getElementById(slug);
    if (!article) { showTop('works'); return; }

    document.body.classList.add('is-detail');
    const detailEl = document.getElementById('work-detail');
    detailEl.removeAttribute('hidden');
    detailEl.innerHTML = `<a href="#works" class="back">‚Üê all works</a>`;

    const media = createMediaBlock(article);
    if (media) detailEl.appendChild(media);

    const clone = article.cloneNode(true);
    clone.removeAttribute('id');
    detailEl.appendChild(clone);
    window.scrollTo(0,0);
  }

  function handleRoute(){
    const h = decodeURIComponent(location.hash || '#works');
    const m = h.match(/^#work\/(.+)$/);
    if (m) { showWork(m[1]); return; }
    const sec = h.replace('#','');
    if (['works','bio','contact'].includes(sec)) showTop(sec);
    else showTop('works');
  }
  window.addEventListener('hashchange', handleRoute);

  function hardenExternalLinks(){
    document.querySelectorAll('a[target="_blank"]').forEach(a=>{
      const rel = (a.getAttribute('rel')||'').split(/\s+/).filter(Boolean);
      if(!rel.includes('noopener')) rel.push('noopener');
      if(!rel.includes('noreferrer')) rel.push('noreferrer');
      a.setAttribute('rel', rel.join(' '));
    });
  }

  // Email obfuscation (semplice)
  function injectMail(){
    const m = 'mariacozzani' + '@' + 'gmail.com';
    const el = document.getElementById('mail');
    if (el) el.innerHTML = `<a href="mailto:${m}">${m}</a>`;
  }

  /* ===== Custom cursor mucca ===== */
  function initCursorCow(){
    const cursorEl = document.getElementById('cursorCow');
    const tpl = document.getElementById('cowSVG');
    if(cursorEl && cursorEl.childElementCount===0 && tpl){
      cursorEl.appendChild(tpl.content.cloneNode(true));
    }
    window.addEventListener('mousemove', (e)=>{
      cursorEl.style.left = e.clientX + 'px';
      cursorEl.style.top  = e.clientY + 'px';
    }, {passive:true});
  }

  /* ===== Engine fuochi d‚Äôartificio di mucche ===== */
  const fxLayer = document.getElementById('fxLayer');
  const cowTpl  = document.getElementById('cowSVG');
  let cowIntensity = 20;      // 0..100
  let emitterCount = 8;
  let emitters = [];
  let activeCows = 0;
  const MAX_COWS_HARD = 500;

  function makeEmitters(n){
    const W = window.innerWidth, H = window.innerHeight;
    emitters = Array.from({length:n}, ()=>({
      x: Math.round(rand(W*0.12, W*0.88)),
      y: Math.round(rand(H*0.12, H*0.88))
    }));
  }
  window.addEventListener('resize', ()=> makeEmitters(emitterCount));

  function spawnCow(x,y,opts={}){
    if(activeCows >= MAX_COWS_HARD) return;
    const p = document.createElement('div');
    p.className = 'cow-particle';
    const ang = Math.random()*Math.PI*2;
    const rad = (opts.radius ?? (60 + Math.random()*140));
    const dx = Math.cos(ang)*rad;
    const dy = Math.sin(ang)*rad;
    p.style.setProperty('--dx', dx+'px');
    p.style.setProperty('--dy', dy+'px');
    p.style.setProperty('--rot', (Math.round(-540 + Math.random()*1080))+'deg');
    p.style.setProperty('--dur', ((opts.dur ?? Math.round(2200 + Math.random()*1200)))+'ms');
    p.style.left = (x-14)+'px';
    p.style.top  = (y-14)+'px';
    if(cowTpl) p.appendChild(cowTpl.content.cloneNode(true));
    fxLayer.appendChild(p);
    activeCows++;
    p.addEventListener('animationend', ()=>{ p.remove(); activeCows--; }, {once:true});
  }

  function burstAround(el, count=28){
    const r = el.getBoundingClientRect();
    const cx = r.left + r.width/2;
    const cy = r.top  + r.height/2;
    for(let i=0;i<count;i++) spawnCow(cx, cy, {radius: 80 + Math.random()*140, dur: 2400 + Math.random()*800});
  }

  function cowEngine(){
    const rate = (cowIntensity/100) * 60; // mucche/sec
    const perFrame = rate/60;             // ~ per frame
    let toSpawn = perFrame;
    if(cowIntensity > 80) toSpawn += (cowIntensity-80)/10; // ‚Äútempesta‚Äù

    if(emitters.length === 0) makeEmitters(emitterCount);

    for(let s = 0; s < toSpawn; s++){
      const e = emitters[Math.floor(Math.random()*emitters.length)];
      spawnCow(e.x, e.y, {radius: 50 + Math.random()*120});
      if(cowIntensity > 65 && Math.random() < 0.25){ // mini-burst casuali
        const extra = Math.round(2 + Math.random()*4);
        for(let k=0;k<extra;k++){
          const ee = emitters[Math.floor(Math.random()*emitters.length)];
          spawnCow(ee.x, ee.y, {radius: 30 + Math.random()*110, dur: 2000 + Math.random()*1000});
        }
      }
    }
    requestAnimationFrame(cowEngine);
  }

  function initCowLab(){
    const intensityEl = document.getElementById('cowIntensity');
    const emittersEl  = document.getElementById('cowEmitters');
    const intensityVal = document.getElementById('cowIntensityVal');
    const emittersVal  = document.getElementById('cowEmittersVal');

    cowIntensity = Number(intensityEl?.value ?? 20);
    emitterCount = Number(emittersEl?.value ?? 8);
    intensityVal.textContent = cowIntensity;
    emittersVal.textContent  = emitterCount;
    makeEmitters(emitterCount);

    intensityEl?.addEventListener('input', ()=>{
      cowIntensity = Number(intensityEl.value);
      intensityVal.textContent = cowIntensity;
    });
    emittersEl?.addEventListener('input', ()=>{
      emitterCount = Number(emittersEl.value);
      emittersVal.textContent = emitterCount;
      makeEmitters(emitterCount);
    });

    // burst intorno al titolo quando ci passi sopra (lento e ben visibile)
    const title = document.getElementById('siteTitle');
    if(title){
      title.addEventListener('mouseenter', ()=> burstAround(title, 36));
    }

    requestAnimationFrame(cowEngine);
  }

  /* ===== Fish-eye continuo per la galleria ===== */
  function initFisheyeContinuous(){
    const items = Array.from(document.querySelectorAll('#thumbs .thumb'));
    if(!items.length) return;

    // fase casuale per item
    const phases = items.map(()=> rand(0, Math.PI*2));
    const amp = 0.08;   // ampiezza scala
    const ampY = 3.0;   // traslazione verticale in px
    const k1 = 0.7, k2 = 1.31;
    let t0 = performance.now();

    function tick(now){
      const t = (now - t0)/1000;
      const n = items.length;
      for(let i=0;i<n;i++){
        const w1 = Math.sin(t*0.8  + i*k1 + phases[i]);
        const w2 = Math.sin(t*1.07 + i*k2 + phases[(i+3)%n]) * 0.6;
        const w  = (w1 + w2) / 1.6; // normalizza
        const s  = 1 + amp * w;
        const ty = (ampY * -w).toFixed(2) + 'px';
        items[i].style.setProperty('--s', s.toFixed(4));
        items[i].style.setProperty('--ty', ty);
      }
      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);
  }

  // Boot
  document.addEventListener('DOMContentLoaded', ()=>{
    buildGallery();
    handleRoute();
    hardenExternalLinks();
    injectMail();

    initCursorCow();
    initCowLab();
    initFisheyeContinuous();

    // nav instant
    document.querySelectorAll('nav a[href^="#"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const target = a.getAttribute('href').slice(1);
        if(['works','bio','contact'].includes(target)){
          e.preventDefault();
          history.replaceState(null,'',`#${target}`);
          showTop(target);
        }
      });
    });
  });
  </script>
</body>
</html>
